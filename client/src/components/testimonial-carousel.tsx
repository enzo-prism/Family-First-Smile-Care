import { useState, useEffect } from "react";
import { Button } from "@/components/ui/button";
import { ChevronLeft, ChevronRight, Star } from "lucide-react";
import type { Testimonial } from "@/lib/types";

const testimonials: Testimonial[] = [
  {
    id: 0,
    name: "Priscilla Barajas",
    title: "Patient & parent",
    content: "They treat my family of seven with so much kindness and care. Every visit feels comfortable, and our kids actually enjoy going to the dentist now. We trust Dr. Chuang and his team completely.",
    rating: 5
  },
  {
    id: 1,
    name: "Kevin Lan",
    title: "Parent",
    content: "Dr Chuang was great for my 2-year-old daughter's first dental visit. He was patient, fun and knew how to interact with toddlers.",
    rating: 5
  },
  {
    id: 2,
    name: "Eternel Elegance",
    title: "Patient",
    content: "I am impressed with the excellent care I have received from Dr. Tim J Chuang and his team. Dr. Chuang is a skilled and caring professional.",
    rating: 5
  },
  {
    id: 3,
    name: "Monica Lee",
    title: "Patient",
    content: "Dr. Chuang is stellar and provides great service! He was very patient and walked me through every step of my annual cleaning. Highly recommend!",
    rating: 5
  },
  {
    id: 4,
    name: "Janey Lee",
    title: "Patient",
    content: "I have some dental anxiety and Dr. Chuang is always readily available with solid advice and a reassuring manner in addressing my concerns.",
    rating: 5
  },
  {
    id: 5,
    name: "Chloe Yue",
    title: "New Patient",
    content: "We moved to Bay mid of last year and Family First Smile Care was the first and ideal dental care that we feel comfortable with.",
    rating: 5
  },
  {
    id: 6,
    name: "Don Goers",
    title: "Patient",
    content: "Cleanings have been a breeze with a fun staff and a knowledgeable and laid-back Doctor leading the team.",
    rating: 5
  },
  {
    id: 7,
    name: "Josephine Lan",
    title: "Patient",
    content: "I had a wonderful experience at this establishment. Dr. Chuang is warm, knowledgeable, and incredibly patient.",
    rating: 5
  },
  {
    id: 8,
    name: "Tiecheng Yang",
    title: "Patient",
    content: "Great dental clinic! Dr Chuang and his team are friendly and professional. My treatment was smooth and painless. Highly recommended!",
    rating: 5
  },
  {
    id: 9,
    name: "Davy H",
    title: "Patient",
    content: "Dr. Chuang's clinic is welcoming, professional, and truly caring. His team provides attentive, personalized care with expertise and kindness.",
    rating: 5
  },
  {
    id: 10,
    name: "Zach Reece",
    title: "Patient",
    content: "Tim and the team here are great. He is patient, transparent, and took time to explain things to me. Definitely would recommend.",
    rating: 5
  }
];

export default function TestimonialCarousel() {
  const [currentIndex, setCurrentIndex] = useState(0);

  const nextTestimonial = () => {
    setCurrentIndex((prev) => (prev + 1) % testimonials.length);
  };

  const previousTestimonial = () => {
    setCurrentIndex((prev) => (prev - 1 + testimonials.length) % testimonials.length);
  };

  const goToTestimonial = (index: number) => {
    setCurrentIndex(index);
  };

  // Auto-advance testimonials every 8 seconds
  useEffect(() => {
    const timer = setInterval(nextTestimonial, 8000);
    return () => clearInterval(timer);
  }, []);

  return (
    <div className="relative max-w-4xl mx-auto">
      <div className="overflow-hidden">
        <div 
          className="flex transition-transform duration-500 ease-in-out"
          style={{ transform: `translateX(-${currentIndex * 100}%)` }}
        >
          {testimonials.map((testimonial) => (
            <div key={testimonial.id} className="w-full flex-shrink-0 px-4">
              <div className="testimonial-card p-8 text-center">
                <div className="flex justify-center mb-4">
                  {[...Array(testimonial.rating)].map((_, i) => (
                    <Star key={i} className="w-5 h-5 text-accent fill-current" />
                  ))}
                </div>
                <p className="text-lg text-gray-700 mb-6 italic">"{testimonial.content}"</p>
                <div className="font-semibold text-gray-800">{testimonial.name}</div>
                <div className="text-sm text-gray-600">{testimonial.title}</div>
              </div>
            </div>
          ))}
        </div>
      </div>
      
      {/* Carousel Navigation */}
      <Button
        variant="outline"
        size="icon"
        className="absolute left-0 top-1/2 transform -translate-y-1/2 bg-white shadow-lg rounded-full"
        onClick={previousTestimonial}
        aria-label="Previous testimonial"
      >
        <ChevronLeft className="h-4 w-4 text-primary" />
      </Button>
      <Button
        variant="outline"
        size="icon"
        className="absolute right-0 top-1/2 transform -translate-y-1/2 bg-white shadow-lg rounded-full"
        onClick={nextTestimonial}
        aria-label="Next testimonial"
      >
        <ChevronRight className="h-4 w-4 text-primary" />
      </Button>
      
      {/* Carousel Indicators */}
      <div className="flex justify-center mt-8 space-x-2">
        {testimonials.map((_, index) => (
          <Button
            key={index}
            variant="ghost"
            size="sm"
            className={`w-3 h-3 rounded-full p-0 ${
              index === currentIndex ? "bg-primary" : "bg-gray-300"
            }`}
            onClick={() => goToTestimonial(index)}
            aria-label={`Go to testimonial ${index + 1}`}
          />
        ))}
      </div>
    </div>
  );
}
